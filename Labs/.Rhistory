load("C:/Users/rydra/OneDrive - PennO365/CPLN 5010 Quantitative Analytics/Assignement 2/cpln501_module2_census_tract.rda")
library(tidyverse)
library(tidycensus)
library(broom)
library(scales)
census_api_key("a55638f442ab081818dbf0ae29a32549253a2ab0")
challenge_data <- get_acs(
geography = "county",
state = "PA",
variables = c(
home_value = "B25077_001",      # YOUR TARGET
total_pop = "B01003_001",       # Total population
median_income = "B19013_001",   # Median household income
median_age = "B01002_001",      # Median age
percent_college = "B15003_022", # Bachelor's degree or higher
median_rent = "B25058_001",     # Median rent
poverty_rate = "B17001_002"     # Population in poverty
),
year = 2022,
output = "wide"
)
install.packages("recipes")
install.packages("caret", dependencies = TRUE)
install.packages("caret", dependencies = TRUE)
train_control <- trainControl(method = "cv", number = 10)
library(tidyverse)
library(tidycensus)
library(broom)
library(scales)
census_api_key("a55638f442ab081818dbf0ae29a32549253a2ab0")
challenge_data <- get_acs(
geography = "county",
state = "PA",
variables = c(
home_value = "B25077_001",      # YOUR TARGET
total_pop = "B01003_001",       # Total population
median_income = "B19013_001",   # Median household income
median_age = "B01002_001",      # Median age
percent_college = "B15003_022", # Bachelor's degree or higher
median_rent = "B25058_001",     # Median rent
poverty_rate = "B17001_002"     # Population in poverty
),
year = 2022,
output = "wide"
)
library(caret)
train_control <- trainControl(method = "cv", number = 10)
cv_model <- train(home_valueE ~ median_incomeE,
data = challenge_data,
method = "lm",
trControl = train_control)
cv_model$results
rm(list=ls())
load("cpln501_module2_census_tract.rda")
load("cpln501_module2_census_tract.rda")
load("C:/Users/rydra/OneDrive - PennO365/CPLN 5010 Quantitative Analytics/Module 2/cpln501_module2_census_tract.rda")
plot(data_for_model$pop, data_for_model$pop_plus10)
rm(list=ls())
load("cpln501_module2_census_tract.rda")
read.csv("cpln501_module2_census_tract.rda")
load("CPLN 5010 Quantitative Analytics/Assignment 2/cpln501_module2_census_tract.rda")
file.exists("CPLN 5010 Quantitative Analytics/Assignment 2/cpln501_module2_census_tract.rda")
load("C:/Users/rydra/Documents/CPLN 5010 Quantitative Analytics/Assignment 2/cpln501_module2_census_tract.rda")
load("C:/Users/rydra/OneDrive - PennO365/CPLN 5010 Quantitative Analytics/Assignment 2/cpln501_module2_census_tract.rda")
rm(list=ls())
load("cpln501_module2_census_tract.rda")
load("C:/Users/rydra/OneDrive - PennO365/CPLN 5010 Quantitative Analytics/Assignement 2/cpln501_module2_census_tract.rda")
plot(data_for_model$pop, data_for_model$pop_plus10)
View(dat_for_model)
plot(dat_for_model$pop, dat_for_model$pop_plus10)
plot(dat_for_model$pop_density, dat_for_model$pop_plus10)
plot(dat_for_model$pop_black, dat_for_model$pop_plus10)
plot(dat_for_model$households, dat_for_model$pop_plus10)
plot(dat_for_model$avg_hh_size, dat_for_model$pop_plus10)
plot(dat_for_model$edu_collegeplus, dat_for_model$pop_plus10)
plot(dat_for_model$pop_civ_employed, dat_for_model$pop_plus10)
plot(dat_for_model$median_hh_income, dat_for_model$pop_plus10)
plot(dat_for_model$per_capita_income, dat_for_model$pop_plus10)
plot(dat_for_model$housing_occupied, dat_for_model$pop_plus10)
plot(dat_for_model$housing_median_age, dat_for_model$pop_plus10)
plot(dat_for_model$percent poverty, dat_for_model$pop_plus10)
train_control <- trainControl(method = "cv", number = 10)
View(train_control)
cv_model <- train(pop_plus10 ~ pop,
data = dat_for_model,
method = "lm",
trControl = train_control)
library(dplyr)
df <- df %>%
drop_na(pop)
plot(dat_for_model$percent_poverty, dat_for_model$pop_plus10)
dat_for_model$residuals <- residuals(cv-mod)
df <- df %>%
drop_na(pop)
dat_for_model <- dat_for_model %>% drop_na(pop)
View(dat_for_model)
dat_for_model <- dat_for_model %>% drop_na(pop)
dat_for_model <- dat_for_model %>% drop_na(pop_density)
dat_for_model <- dat_for_model %>% drop_na(pop_black)
dat_for_model <- dat_for_model %>% drop_na(households)
dat_for_model <- dat_for_model %>% drop_na(avg_hh_size)
dat_for_model <- dat_for_model %>% drop_na(edu_collegeplus)
dat_for_model <- dat_for_model %>% drop_na(pop_civ_employed)
dat_for_model <- dat_for_model %>% drop_na(median_hh_income)
dat_for_model <- dat_for_model %>% drop_na(per_capita_income)
dat_for_model <- dat_for_model %>% drop_na(housing_occupied)
dat_for_model <- dat_for_model %>% drop_na(housing_median_age)
dat_for_model <- dat_for_model %>% drop_na(percent_poverty)
train_control <- trainControl(method = "cv", number = 10)
cv-mod <- lm(pop_plus10 ~ year + pop, data = df, na.action = na.omit)
train_control <- trainControl(method = "cv", number = 10)
cv-mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = challenge_data,
method = "lm",
trControl = train_control)
cv-mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model,
method = "lm",
trControl = train_control)
v-mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model)
mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model)
View(mod)
train_control <- trainControl(method = "cv", number = 10)
mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model,
method = "lm",
trControl = train_control)
model <- train(pop_plus10 ~ pop,
data = dat_for_model,
method = "lm",
trControl = train_control)
dat_for_model <- dat_for_model %>% drop_na(pop_plus10)
mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model)
train_control <- trainControl(method = "cv", number = 10)
mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model,
method = "lm",
trControl = train_control)
mod <- train(pop_plus10 ~ pop,
data = dat_for_model,
method = "lm",
trControl = train_control)
mod$results
mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_median_age + percent_poverty, data = dat_for_model)
train_control <- trainControl(method = "cv", number = 10)
mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model,
method = "lm",
trControl = train_control)
mod <- train(pop_plus10 ~ pop,
data = dat_for_model,
method = "lm",
trControl = train_control)
mod$results
train_control <- trainControl(method = "cv", number = 10)
mod_noemployed <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus + median_hh_income + per_capita_income + housing_occupied + housing_median_age + percent_poverty, data = dat_for_model,
method = "lm",
trControl = train_control)
mod_noemployed <- train(pop_plus10 ~ pop,
data = dat_for_model,
method = "lm",
trControl = train_control)
mod_noemployed$results
mod <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + avg_hh_size + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income  + housing_median_age + percent_poverty, data = dat_for_model,
method = "lm",
trControl = train_control)
mod <- train(pop_plus10 ~ pop,
data = dat_for_model,
method = "lm",
trControl = train_control)
mod_noemployed$results
mod$results
train_control <- trainControl(method = "cv", number = 10)
mod2 <- lm(pop_plus10 ~ pop + pop_density + pop_black + households + edu_collegeplus +
pop_civ_employed + median_hh_income + per_capita_income + percent_poverty, data = dat_for_model,                     method = "lm",
trControl = train_control)
mod2 <- train(pop_plus10 ~ pop,
data = dat_for_model,
method = "lm",
trControl = train_control)
mod2$results
mod_black <- lm(pop_plus10 ~ pop_black, data = dat_for_model)
dat_for_model$residuals <- residuals(mod_black)
dat_for_model$fitted <- fitted(mod_black)
ggplot(mod_black, aes(x = fitted, y = residuals)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(title = "Residual Plot", x = "Fitted Values", y = "Residuals") +
theme_minimal()
ggplot(dat_for_model, aes(x = fitted, y = residuals)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(title = "Residual Plot", x = "Fitted Values", y = "Residuals") +
theme_minimal()
View(mod_black)
train_control <- trainControl(method = "cv", number = 10)
mod_black <- lm(pop_plus10 ~ pop_black, data = dat_for_model,
method = "lm",
trControl = train_control)
mod_black <- train(pop_plus10 ~ pop_black,
data = dat_for_model,
method = "lm",
trControl = train_control)
mod_black$results
#test mod_black
train_control <- trainControl(method = "cv", number = 10)
mod_blackandpop <- lm(pop_plus10 ~ pop + pop_black, data = dat_for_model,
method = "lm",
trControl = train_control)
mod_blackandpop <- train(pop_plus10 ~ pop + pop_black,
data = dat_for_model,
method = "lm",
trControl = train_control)
mod_blackandpop$results
